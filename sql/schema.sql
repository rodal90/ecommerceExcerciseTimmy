create table Budget (currentAmount DECIMAL(10,2) DEFAULT 0 CHECK(CURRENTAMOUNT >= 0.0) not null, id bigint generated by default as identity, idCurrentStatus bigint, primary key (id));
create table Comunication (amount float(53), messageDate date, id bigint generated by default as identity, idBudget bigint, idContact bigint, idStatus bigint, message varchar(255), primary key (id));
create table CUSTOMER (id bigint not null, accountNumber CHAR(20)CHECK(ACCOUNTNUMBER REGEXP '^[0-9]{0,20}'), primary key (id));
create table CUSTOMER_CONTACT (id bigint generated by default as identity, idPersonOfInterest bigint, phone CHAR(18) CHECK(LENGTH(PHONE) >= 9) not null, name VARCHAR(150)  CHECK(LENGTH(NAME) >= 10) not null, email varchar(255), observations varchar(255), primary key (id));
create table PERSON_OF_INTEREST (id bigint generated by default as identity, phone CHAR(18) CHECK(LENGTH(VATNUMBER) >= 9) not null, cif VARCHAR(30) CHECK(LENGTH(CIF) >= 9), vatnumber VARCHAR(30) CHECK(LENGTH(VATNUMBER) >= 11), name VARCHAR(150) CHECK(LENGTH(NAME) >= 10) not null, address VARCHAR(520) DEFAULT 'TBD', email varchar(255), primary key (id));
create table PROVIDER (id bigint not null, nif VARCHAR(9) CHECK(LENGTH(NIF) >= 2) CHECK(NIF REGEXP '^[0-9]{1,8}[A-Za-z]{1}'), primary key (id));
create table ROLES (rolename varchar(255) not null, primary key (rolename));
create table STATUS (id bigint generated by default as identity, statusName VARCHAR(50) DEFAULT 'STATUS' not null, primary key (id));
create table USERS (enabled boolean, expiryDateAccount date, expiryDateCredentials date, lockedAccount boolean, email varchar(255), fullname varchar(255), password varchar(255), username varchar(255) not null, primary key (username));
create table USERS_HAS_ROLES (User_username varchar(255) not null, roleSet_rolename varchar(255) not null, primary key (User_username, roleSet_rolename));
alter table if exists Budget add constraint FK6nelshx4tjyn8vr9b1clpwl8 foreign key (idCurrentStatus) references STATUS;
alter table if exists Comunication add constraint FKebxjxvoqbx2x51sjjnthh7won foreign key (idBudget) references Budget;
alter table if exists Comunication add constraint FK3yuvx1p684fve3p27lqxwrwv4 foreign key (idContact) references CUSTOMER_CONTACT;
alter table if exists Comunication add constraint FKse5grlm95v9tqfk5qipjxjxex foreign key (idStatus) references STATUS;
alter table if exists CUSTOMER add constraint FKkurfjvemgr8aig8gk57k0e3u3 foreign key (id) references PERSON_OF_INTEREST;
alter table if exists CUSTOMER_CONTACT add constraint FKr4ta5n0cslbkrfr2541xg3954 foreign key (idPersonOfInterest) references PERSON_OF_INTEREST;
alter table if exists PROVIDER add constraint FKie2sb28ul6quw2dwfms9lc3k9 foreign key (id) references PERSON_OF_INTEREST;
alter table if exists USERS_HAS_ROLES add constraint FK40jy793cg5kbts0087cm4engd foreign key (roleSet_rolename) references ROLES;
alter table if exists USERS_HAS_ROLES add constraint FKfy7x7il32rr6kyeos1va1fvh5 foreign key (User_username) references USERS;
